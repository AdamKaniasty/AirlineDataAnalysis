Name,Query
AirportWithMostWeatherDelays,"Select airport, count(*) as totalFLights, avg(WeatherDelay) as averageWeatherDelay from main
inner join airports ON (Trim(main.Origin) = Trim('""' from airports.iata))
where Year between 2005 and 2007
group by airport
having totalFLights > 50000
order by averageWeatherDelay desc
limit 3;"
AtlantaDestinationsWithWeatherDelays,"Select a2.city, count(*) as totalFlights, avg(WeatherDelay) as averageWeatherDelay from main m
inner join airports a1 ON (Trim(m.Origin) = Trim('""' from a1.iata))
inner join airports a2 ON (Trim(m.Dest) = Trim('""' from a2.iata))
where a1.city like '%Atlanta%'
and Year between 2005 and 2007
group by a2.city
having totalFlights > 50000
order by averageWeatherDelay desc
limit 3;"
AtlantaBT,"SELECT date, count(*) totalFlights, sum(Cancelled) as cancelled, Avg(ArrDelay), Avg(DepDelay), AVG(TaxiIn),avg(TaxiOut), Avg(WeatherDelay)  from main m
inner join airports a1 ON (Trim(m.Origin) = Trim('""' from a1.iata))
inner join airports a2 ON (Trim(m.Dest) = Trim('""' from a2.iata))
where a1.city like '%Atlanta%' and a2.city like '%Baton Rouge%'
and Year between 2005 and 2007
group by date"